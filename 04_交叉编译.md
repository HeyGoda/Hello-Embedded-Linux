# 04_交叉编译

嵌入式Linux系统中的应用程序由特定的交叉编译工具链编译得到，此工具链一般由芯片原厂提供或指定，因为系统的内核、libc等程序运行的基础环境都由该工具链编译得到，所有应用程序最好也用此工具工具链来编译；

尽管如此，依然可以使用通用的交叉编译工具链来做测试，例如在Ubuntu下可以安装[gcc-arm-linux-gnueabi](https://packages.ubuntu.com/bionic/gcc-arm-linux-gnueabi)或[gcc-arm-linux-gnueabihf](https://packages.ubuntu.com/bionic/gcc-arm-linux-gnueabihf)来编译针对ARM芯片的程序，如下：

```
$ sudo apt install gcc-arm-linux-gnueabihf
```

## 编译方法可大致分为以下2种：

- ##### 自己写的代码直接使用工具链编译即可；

```
arm-linux-gnueabihf-gcc main.c -o main.elf
```

- ##### 公开的开源程序，一般使用下面的步骤编译（某些程序会有所差别）：

```
./configure --prefix=$(pwd)/cross_install --host=arm-linux-gnueabihf
make
make install
```

下面是一些开源程序的交叉编译方法

###### [BusyBox](https://busybox.net/)

[BusyBox](https://baike.baidu.com/item/busybox) 是一个集成了三百多个最常用Linux命令和工具的软件。BusyBox 包含了一些简单的工具，例如ls、cat和echo等等，还包含了一些更大、更复杂的工具，例grep、find、mount以及telnet。有些人将 BusyBox 称为 Linux 工具里的瑞士军刀。简单的说BusyBox就好像是个大工具箱，它集成压缩了 Linux 的许多工具和命令，也包含了 Linux 系统的自带的shell。

```
# 下载代码，并更新到最近的稳定版本
git clone git://git.busybox.net/busybox
cd busybox
git reset --hard 1_33_2

# 采用默认配置，参考https://busybox.net/FAQ.html和Makefile进行交叉编译
make defconfig
make -j 4 CROSS_COMPILE=arm-linux-gnueabihf-
# 以下为静态编译
# LDFLAGS="--static" make -j 4 CROSS_COMPILE=arm-linux-gnueabihf-
make install
# 编译后生成的可执行程序在_install目录下
```

BusyBox使用参考：[BusyBox - The Swiss Army Knife of Embedded Linux](https://busybox.net/downloads/BusyBox.html)

###### [Opus](https://opus-codec.org/)

[Opus](https://baike.baidu.com/item/opus/680370)是一个有损声音编码的格式，由Xiph.Org基金会开发，之后由IETF（互联网工程任务组）进行标准化，目标是希望用单一格式包含声音和语音，取代Speex和Vorbis，且适用于网络上低延迟的即时声音传输，标准格式定义于RFC 6716文件。Opus格式是一个开放格式，使用上没有任何专利或限制。

```
# opus包含有几个代码库，这里编译opus-tools编解码工具及其依赖的第三方库
# 下载
git clone https://github.com/xiph/opus-tools.git
git clone https://github.com/xiph/opusfile.git
git clone https://github.com/xiph/libopusenc.git
git clone https://github.com/xiph/opus.git
git clone https://github.com/xiph/ogg.git
git clone https://github.com/openssl/openssl.git


```



